{% extends 'base.html' %}
{% block title %} Recipe Details {% endblock %}

{% block body %}

{% if is_API %}
    <h1 id="title"> {{ recipe['title'] }}</h1>
    {% if recipe.recipe_id in rated_recipe_ids %}
    You rated this {{rating.score}} out of 5
    {% endif %}
    <form>
    <p>
    <a href="{{recipe['sourceUrl']}}">
        {{recipe['sourceUrl']}}
        
    </a>
    </p>
    </form>

    {% if session.get('user_email') %}
        {% if recipe_id not in saved_recipe_ids %}
        <button id="save">Save Recipe</button>
        {% endif %}
    <p>
    <h2>Rate Recipe</h2>
    <form id= "rate" method="POST">
        <input type="hidden" name="source_url" id="source" value="{{recipe['sourceUrl']}}">
        <p>
        Rating:
        <select name="rating" id="rating">
            <option value="">Select rating</option>
            {% for num in range(6) %}
            <option value="{{ num }}">{{ num }}</option>
            {% endfor %}
        </select>
        </p>
        <p><input type="submit"></p>
    </form>
    {% endif %}

    <img src="{{recipe['image']}}" width="25%">
    <input type="hidden" id="image" value="{{recipe['image']}}">
    
    <div>    
        <ul id="ingredients">
        {% for ingredient in ingredients %}
            <li>
            {{ ingredient }}
            </li>
            {% endfor %}
        </div>             
            <div>        
            <p>
            <ul id="instructions">
                {% for instruction in instructions %}
                    <li>
                        {{ instruction }}
                    </li>
                        {% endfor %}
                </ul>
                </p>
            </div>
    <input type="hidden" name="source_url" id="source_url" value="{{recipe['sourceUrl']}}">
    </p>
{% endif %}

{% if not is_API %}
    <h1 id='title'>{{ recipe.title }}</h1>
    <input type="hidden" name="source_url" id="source_url" value="{{recipe.source_url}}">
    {% if recipe.recipe_id in rated_recipe_ids %}
    You rated this {{rating.score}} out of 5
    {% endif %}
    <form>
    
    <p>
    <a name="source" href="{{ recipe.source_url}}">
        {{recipe.source_url}}
    </a>
    </p>
    </form>

    {% if session.get('user_email') %}
        {% if recipe.recipe_id in saved_recipe_ids %}
        <div id="edit">This recipe is in your Cookbook. Would you like to edit it?
            <button id="edit">Edit Recipe</button>
        </div>
        {% endif %}
    <p>
        {% if recipe.recipe_id not in rated_recipe_ids %}
        <h2>Rate Recipe</h2>
            <form id="rate" method="POST">
            <input type="hidden" name="recipe_id" value={{recipe.recipe_id}}>
                <p>
                Rating:
                <select name="rating" id="rating">
                <option value="">Select rating</option>
                    {% for num in range(6) %}
                    <option value="{{ num }}">{{ num }}</option>
            {% endfor %}
            </select>
        </p>
        <p><input type="submit"></p>
        </form>
        {% endif %}
    {% endif %}

    <p>
    <img src="{{ recipe.image_path }}" width="25%">
    <input type="hidden" id="image" name="image" value="{{recipe.image_path}}">
    </p>


    <div id="ingredients">
    {{ recipe.ingredients}}
    </div>
    <p>
    <div id="instructions">
    {{ recipe.instructions }}
    </p>
    </div>
    <div id="edit_recipe"></div>
{% endif %}

<script src="/static/save.js"></script>
<script src="/static/edit.js"></script>
{% endblock %}